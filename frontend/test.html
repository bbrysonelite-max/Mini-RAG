<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Mini-RAG Test</title>
<style>
body{font-family:sans-serif;padding:2rem;max-width:800px;margin:0 auto}
textarea{width:100%;height:100px;margin:1rem 0;padding:0.5rem}
button{padding:0.75rem 1.5rem;background:#111;color:white;border:none;cursor:pointer;font-size:1rem}
button:hover{background:#333}
#answer{background:#f5f5f5;padding:1rem;margin:1rem 0;white-space:pre-wrap;min-height:100px}
</style>
</head>
<body>
<h1>Mini-RAG - Simple Test</h1>

<h3>Ask a Question</h3>
<textarea id="q" placeholder="Type your question here...">What is my operating style?</textarea>
<button id="askBtn">Ask</button>

<h3>Answer</h3>
<div id="answer">Click Ask to get an answer...</div>

<h3>Debug Info</h3>
<div id="debug"></div>

<script>
console.log("Script loading...");

function $(id){return document.getElementById(id)}

const askBtn = $("askBtn");
const qInput = $("q");
const answerDiv = $("answer");
const debugDiv = $("debug");

console.log("Elements found:", {askBtn, qInput, answerDiv});

askBtn.onclick = async () => {
  console.log("Button clicked!");
  debugDiv.textContent = "Button clicked at " + new Date().toLocaleTimeString();
  
  const query = qInput.value;
  if(!query.trim()){
    alert("Please enter a question");
    return;
  }
  
  askBtn.disabled = true;
  askBtn.textContent = "Searching...";
  answerDiv.textContent = "Searching...";
  
  try{
    const formData = new FormData();
    formData.append("query", query);
    formData.append("k", "5");
    
    console.log("Fetching /ask...");
    const response = await fetch("/ask", {
      method: "POST",
      body: formData
    });
    
    console.log("Response status:", response.status);
    const data = await response.json();
    console.log("Response data:", data);
    
    if(data.answer){
      answerDiv.textContent = data.answer;
      debugDiv.textContent = `Score: ${data.score?.total || 0}/100 | Chunks: ${data.chunks?.length || 0}`;
    }else if(data.detail){
      answerDiv.textContent = "Error: " + data.detail;
    }else{
      answerDiv.textContent = "No answer returned";
    }
  }catch(e){
    console.error("Error:", e);
    answerDiv.textContent = "Error: " + e.message;
    debugDiv.textContent = "Error: " + e.message;
  }finally{
    askBtn.disabled = false;
    askBtn.textContent = "Ask";
  }
};

console.log("Handler attached! Ready to use.");
debugDiv.textContent = "Page loaded - script initialized successfully";
</script>
</body>
</html>






